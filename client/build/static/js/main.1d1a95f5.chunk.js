(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{214:function(e,t,a){e.exports=a(402)},219:function(e,t,a){},402:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(14),s=a.n(i),l=(a(219),a(21)),o=a(20),c=a(24),u=a(25),d=a(26),h=a(18),m=a(4),p=a(5),f=a(455),g=a(450),v=a(451),E=a(440),b=a(452),k=a(442),w=a(403);function y(e){return r.a.createElement(E.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},e.children)}var O=a(13),j=a(443),D="http://localhost:8000/api",C=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={state:"IDLE",start:new Date,duration:0},a.sendStartRequest=a.sendStartRequest.bind(Object(O.a)(a)),a.sendEndRequest=a.sendEndRequest.bind(Object(O.a)(a)),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.watchState()}},{key:"componentWillUnmount",value:function(){this.stopStopwatch(),clearInterval(this.stateInterval)}},{key:"watchState",value:function(){var e=this;this.stateInterval=setInterval(function(){fetch(D+"/timer").then(function(e){return e.json()}).then(function(t){switch(t.state){case"IDLE":e.stopStopwatch(),e.setState({state:t.state});break;case"WORKING":var a=new Date(t.start);e.state.start!==a&&(e.setState({state:t.state,start:a}),e.startStopwatch());break;default:console.log(t)}})},1e3)}},{key:"sendStartRequest",value:function(){this.setState({state:"WORKING",start:new Date}),fetch(D+"/timer?action=START",{method:"PUT"}).then(function(e){return e.json()}).then(function(e){return console.log(e)})}},{key:"sendEndRequest",value:function(){this.setState({state:"IDLE"}),fetch(D+"/timer?action=END",{method:"PUT"}).then(function(e){return e.json()}).then(function(e){})}},{key:"startStopwatch",value:function(){var e=this;clearInterval(this.stopwatchInterval),this.stopwatchInterval=setInterval(function(){var t=new Date-e.state.start;e.setState({duration:t})},100)}},{key:"stopStopwatch",value:function(){clearInterval(this.stopwatchInterval)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{component:"h1",variant:"h1",color:"primary",align:"center"},function(e){var t=Math.floor(e/36e5%60),a=Math.floor(e/6e4%60),n=Math.floor(e/1e3%60);return(t=t<10?"0"+t:t)+":"+(a=a<10?"0"+a:a)+":"+(n=n<10?"0"+n:n)}(this.state.duration)),r.a.createElement(k.a,{container:!0,spacing:3,justify:"center",alignItems:"center"},r.a.createElement(k.a,{item:!0,xs:6,sm:4,md:2,lg:2},r.a.createElement(j.a,{onClick:this.sendStartRequest,disabled:"WORKING"===this.state.state,variant:"outlined",color:"primary",fullWidth:!0},"Start Working")),r.a.createElement(k.a,{item:!0,xs:6,sm:4,md:2,lg:2},r.a.createElement(j.a,{onClick:this.sendEndRequest,disabled:"IDLE"===this.state.state,variant:"outlined",color:"secondary",fullWidth:!0},"End Session"))))}}]),t}(n.Component),R=a(28),S=function(e){function t(e){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).call(this,e))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(y,null," Summary "),r.a.createElement(R.d,null,r.a.createElement(R.c,{margin:{top:32,right:32,bottom:0,left:0},data:this.props.data},r.a.createElement(R.f,{dataKey:"day"}),r.a.createElement(R.g,{yAxisId:"duration",domain:[0,"dataMax"]}),r.a.createElement(R.g,{yAxisId:"rating",domain:[0,10],orientation:"right"}),r.a.createElement(R.e,null),r.a.createElement(R.a,null),r.a.createElement(R.b,{type:"monotone",yAxisId:"duration",dataKey:"duration",stroke:"#8884d8",strokeWidth:3,activeDot:{r:8},connectNulls:!0}),r.a.createElement(R.b,{type:"monotone",yAxisId:"rating",dataKey:"rating",stroke:"red",strokeWidth:3,activeDot:{r:8},connectNulls:!0}))))}}]),t}(n.Component),T=a(447),I=a(449),N=a(446),x=a(448),M=a(445),q=a(444),W=a(181),U=a.n(W),H=a(456),P=a(453),B=a(180),F=a.n(B),V=a(178),A=a.n(V),K=a(177),G=a.n(K),L=a(179),J=a.n(L),z=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).ratingSelected=function(e){a.setState({rating:e.target.value})},a.taskOnChange=function(e){a.setState({tasks:e.target.value})};var n=new Date(a.props.row.start);n.setMinutes(0),n.setHours(0);var r=new Date(a.props.row.start),i=new Date(a.props.row.end);return a.state={editing:a.props.editing,valid:{date:!0,start:!0,end:!0},date:n,start:r,end:i,rating:a.props.row.rating,tasks:a.props.row.tasks},a.startEditing=a.startEditing.bind(Object(O.a)(a)),a.stopEditing=a.stopEditing.bind(Object(O.a)(a)),a.dateOnChange=a.dateOnChange.bind(Object(O.a)(a)),a.startOnChange=a.startOnChange.bind(Object(O.a)(a)),a.endOnChange=a.endOnChange.bind(Object(O.a)(a)),a.updateRow=a.updateRow.bind(Object(O.a)(a)),a.deleteRow=a.deleteRow.bind(Object(O.a)(a)),a.ratingSelected=a.ratingSelected.bind(Object(O.a)(a)),a.taskOnChange=a.taskOnChange.bind(Object(O.a)(a)),a.checkValidation=a.checkValidation.bind(Object(O.a)(a)),a.createTableRow=a.createTableRow.bind(Object(O.a)(a)),a.createEditableTableRow=a.createEditableTableRow.bind(Object(O.a)(a)),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"startEditing",value:function(){this.setState({editing:!0})}},{key:"stopEditing",value:function(){this.setState({editing:!1})}},{key:"updateRow",value:function(){var e=this.props.row.rowid,t=this.state,a=t.start,n=t.end,r=t.rating,i=t.tasks;this.checkValidation()&&(this.props.update(e,a.getTime(),n.getTime(),r,i),this.stopEditing())}},{key:"checkValidation",value:function(){var e=this.state.valid;return e.date&e.start&e.end}},{key:"deleteRow",value:function(){this.props.delete(this.props.row.rowid)}},{key:"ratingItems",value:function(){return["",10,9,8,7,6,5,4,3,2,1].map(function(e){return e?r.a.createElement(H.a,{key:e,value:e},e):r.a.createElement(H.a,{key:0,value:""},"")})}},{key:"dateOnChange",value:function(e){var t=e.target.valueAsDate;t=new Date(t.getTime()+864e5);var a=this.state.valid;if(!t)return a.date=!1,void this.setState({valid:a});a.date=!0;var n=this.state,r=n.start,i=n.end,s=r.getHours(),l=r.getMinutes(),o=i.getHours(),c=i.getMinutes(),u=new Date(t.getTime()),d=new Date(t.getTime());u.setHours(s),u.setMinutes(l),d.setHours(o),d.setMinutes(c),this.setState({date:t,start:u,end:d,valid:a})}},{key:"startOnChange",value:function(e){var t=e.target.value,a=this.state.valid;if(!t)return a.start=!1,void this.setState({valid:a});a.start=!0;var n=new Date(this.state.date.getTime());n.setHours(t.slice(0,2)),n.setMinutes(t.slice(3,5));for(var r=this.state.end;r-n<0;)r=new Date(r.getTime()+864e5);for(;r-n>864e5;)r=new Date(r.getTime()-864e5);this.setState({start:n,end:r,valid:a})}},{key:"endOnChange",value:function(e){var t=e.target.value,a=this.state.valid;if(!t)return a.end=!1,void this.setState({valid:a});a.end=!0;var n=new Date(this.state.date.getTime());n.setHours(t.slice(0,2)),n.setMinutes(t.slice(3,5));for(var r=this.state.start;n-r<0;)n=new Date(n.getTime()+864e5);for(;n-r>864e5;)n=new Date(n.getTime()-864e5);this.setState({end:n,valid:a})}},{key:"getDuration",value:function(e,t){var a=t-e,n=Math.floor(a/36e5%60),r=Math.floor(a/6e4%60);return n?n+" hours and "+r+" minutes":r+" minutes"}},{key:"formatTimeInput",value:function(e){var t=e.getHours(),a=e.getMinutes();return(t=t<10?"0"+t:t)+":"+(a=a<10?"0"+a:a)}},{key:"formatTime",value:function(e){var t=e.getHours(),a=e.getMinutes();return a=a<10?"0"+a:a,t>12?(t=(t%=12)<10?"0"+t:t)+":"+a+" PM":t+":"+a+" AM"}},{key:"actionButtons",value:function(e,t){return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,{color:"primary",className:t.button,"aria-label":"delete",onClick:this.updateRow},r.a.createElement(G.a,null)),r.a.createElement(q.a,{color:"secondary",className:t.button,"aria-label":"delete",onClick:this.deleteRow},r.a.createElement(A.a,null)),r.a.createElement(q.a,{color:"default",className:t.button,"aria-label":"delete",onClick:this.stopEditing},r.a.createElement(J.a,null))):r.a.createElement(q.a,{color:"primary",className:t.button,"aria-label":"delete",onClick:this.startEditing},r.a.createElement(F.a,null))}},{key:"createTableRow",value:function(e,t,a,n,i,s,l){var o=this.getDuration(a,n),c=this.formatTime(a),u=this.formatTime(n);return r.a.createElement(M.a,{key:e},r.a.createElement(N.a,null,t.toLocaleDateString()),r.a.createElement(N.a,null,c),r.a.createElement(N.a,null,u),r.a.createElement(N.a,null,o),r.a.createElement(N.a,null,i),r.a.createElement(N.a,null,s),r.a.createElement(N.a,{align:"right"},this.actionButtons(!1,this.props.classes)))}},{key:"createEditableTableRow",value:function(e,t,a,n,i,s,l){var o=this.getDuration(a,n),c=this.formatTimeInput(a),u=this.formatTimeInput(n);return r.a.createElement(M.a,{key:e},r.a.createElement(N.a,null,r.a.createElement(P.a,{id:"date",type:"date",defaultValue:t.toJSON().slice(0,10),onChange:this.dateOnChange,className:l.textField})),r.a.createElement(N.a,null,r.a.createElement(P.a,{id:"start",type:"time",defaultValue:c,onChange:this.startOnChange,className:l.textField,inputProps:{step:60}})),r.a.createElement(N.a,null,r.a.createElement(P.a,{id:"time",type:"time",defaultValue:u,onChange:this.endOnChange,className:l.textField,inputProps:{step:60}})),r.a.createElement(N.a,null,r.a.createElement(P.a,{disabled:!0,id:"standard-disabled",value:o,className:l.textField,margin:"normal"})),r.a.createElement(N.a,null,r.a.createElement(P.a,{id:"standard-number",type:"number",value:this.state.rating,onChange:this.ratingSelected,className:l.textField,margin:"normal",autoWidth:!0,select:!0},this.ratingItems())),r.a.createElement(N.a,null,r.a.createElement(P.a,{id:"row-tasks",className:l.textField,placeholder:"task1, task2, task3",defaultValue:this.state.tasks,onChange:this.taskOnChange,margin:"normal"})),r.a.createElement(N.a,{align:"right"},this.actionButtons(this.state.editing,this.props.classes)))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,n=a.editing,r=a.date,i=a.start,s=a.end,l=a.rating,o=a.tasks,c=this.props.row.rowid;return n?e.createEditableTableRow(c,r,i,s,l,o,t):e.createTableRow(c,r,i,s,l,o,t)}}]),t}(n.Component),$="http://localhost:8000/api",Q=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={timesheet:[]},a.sendDeleteRequest=a.sendDeleteRequest.bind(Object(O.a)(a)),a.sendUpdateRequest=a.sendUpdateRequest.bind(Object(O.a)(a)),a.sendCreateRequest=a.sendCreateRequest.bind(Object(O.a)(a)),a.refreshTimesheet=a.refreshTimesheet.bind(Object(O.a)(a)),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.refreshInterval=setInterval(this.refreshTimesheet,500),this.refreshTimesheet()}},{key:"componentWillUnmount",value:function(){clearInterval(this.refreshInterval)}},{key:"refreshTimesheet",value:function(){var e=this;fetch($+"/timesheet").then(function(e){return e.json()}).then(function(t){1===t.result&&e.setState({timesheet:t.rows})})}},{key:"sendUpdateRequest",value:function(e,t,a,n,r){var i=this;t&&a?fetch($+"/timesheet/"+e+"?start="+encodeURIComponent(t)+"&end="+encodeURIComponent(a)+"&rating="+encodeURIComponent(n)+"&tasks="+encodeURIComponent(r),{method:"post"}).then(function(e){return e.json()}).then(function(e){1===e.result&&i.refreshTimesheet()}):console.log("invalid!")}},{key:"sendDeleteRequest",value:function(e){var t=this;fetch($+"/timesheet/"+e,{method:"delete"}).then(function(e){return e.json()}).then(function(e){1===e.result&&t.refreshTimesheet()})}},{key:"sendCreateRequest",value:function(){var e=this,t=new Date,a=new Date;fetch($+"/timesheet?start="+encodeURIComponent(t)+"&end="+encodeURIComponent(a)+"&rating="+encodeURIComponent("")+"&tasks="+encodeURIComponent(""),{method:"post"}).then(function(e){return e.json()}).then(function(t){1===t.result&&e.refreshTimesheet()})}},{key:"refresh",value:function(){this.setState({refresh:!this.state.refresh})}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k.a,{container:!0,spacing:3,justify:"space-between",alignItems:"center"},r.a.createElement(k.a,{item:!0},r.a.createElement(y,null," Timesheet "))),r.a.createElement(T.a,{size:"medium",onClick:this.tableClick},r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement(N.a,null,"Date"),r.a.createElement(N.a,null,"Start Time"),r.a.createElement(N.a,null,"End Time"),r.a.createElement(N.a,null,"Duration"),r.a.createElement(N.a,null,"Rating"),r.a.createElement(N.a,null,"Task(s)"),r.a.createElement(N.a,{align:"right"},r.a.createElement(q.a,{color:"primary",className:t.button,"aria-label":"delete",onClick:this.sendCreateRequest},r.a.createElement(U.a,null))))),r.a.createElement(I.a,null,this.state.timesheet.map(function(a){return r.a.createElement(z,{key:a.rowid,row:a,classes:t,delete:e.sendDeleteRequest,update:e.sendUpdateRequest})}))))}}]),t}(n.Component);function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(a,!0).forEach(function(t){Object(h.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Z="http://localhost:8000/api",_=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={timerState:"haha",weekHours:0,chartData:[]},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return fetch(Z+"/timer").then(function(e){return e.json()}).then(function(t){t.state!==e.state.timerState&&e.setState({timerState:t.state})})},1e3),fetch(Z+"/statistics").then(function(e){return e.json()}).then(function(t){e.setState({weekHours:t.hours,chartData:e.formatChartDate(t.data)})})}},{key:"formatChartDate",value:function(e){for(var t=[],a=new Date,n=0;n<7;n++){var r=new Date(a.getTime()-864e5*n).toDateString();if(r in e){var i=e[r].ratings;if(i.length<1)var s=null;else if(1==i.length)s=i[0];else s=i.reduce(function(e,t){return e+t})/i.length;var l=e[r].duration/36e5;l=Math.round(100*l)/100,t.push({day:r,duration:l,rating:s})}else t.push({day:r,duration:0,rating:null})}return t.reverse()}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this.props.classes,t=Object(m.a)(e.paper,e.fixedHeight);return r.a.createElement("div",{className:e.root},r.a.createElement(f.a,null),r.a.createElement(g.a,{className:e.appBar},r.a.createElement(v.a,{className:e.toolbar},r.a.createElement(E.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:e.title},"Work Clock"))),r.a.createElement("main",{className:e.content},r.a.createElement("div",{className:e.appBarSpacer}),r.a.createElement(b.a,{maxWidth:"lg",className:e.container},r.a.createElement(k.a,{container:!0,spacing:3},r.a.createElement(k.a,{item:!0,xs:12},r.a.createElement(w.a,{className:e.paper},r.a.createElement(C,null))),r.a.createElement(k.a,{item:!0,xs:12,md:8,lg:9},r.a.createElement(w.a,{className:t},r.a.createElement(S,{data:this.state.chartData}))),r.a.createElement(k.a,{item:!0,xs:12,md:4,lg:3},r.a.createElement(w.a,{className:t},r.a.createElement(E.a,{component:"h2",variant:"h2",color:"primary",align:"left"},Math.round(100*this.state.weekHours)/100),r.a.createElement(y,null," Hours Worked ",r.a.createElement("br",null)," This Week "))),r.a.createElement(k.a,{item:!0,xs:12},r.a.createElement(w.a,{className:e.paper},r.a.createElement(Q,{classes:e})))))))}}]),t}(n.Component),ee=Object(p.a)(function(e){return{root:{display:"flex"},appBar:{},toolbar:{},title:{flexGrow:1},content:{flexGrow:1,height:"100vh",overflow:"auto"},appBarSpacer:Y({},e.mixins.toolbar),container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240},button:{},icon:{margin:e.spacing(2)},textField:{},MuiSelect:{select:{padding:void 0,paddingRight:e.spacing(4),height:void 0},selectMenu:{lineHeight:void 0}}}},{withTheme:!0})(_);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[214,1,2]]]);
//# sourceMappingURL=main.1d1a95f5.chunk.js.map